(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{23:function(e,t,n){},31:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(24),s=n.n(i),r=(n(31),n(3)),o=n(2),l=n(4),u=n.p+"static/media/spinner.c233b9e0.svg",j=Object(a.createContext)({_id:null,email:"",name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",about:"",avatar:u}),b=n(8),d=n.p+"static/media/logo.9efe1e8a.svg",m=n.p+"static/media/menu.a46d5c1c.svg",p=n.p+"static/media/close_icon.a004a2d5.svg",_=n(0);function f(e){var t=e.openMenu,n=e.setOpenMenu,c=Object(l.g)(),i=Object(a.useContext)(j),s=i.setIsloggedIn,r=i.currentUser,o=i.setCurrentUser;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"header__menu ".concat(t?"header__menu_visible":""),children:[Object(_.jsx)("span",{className:"header__email",children:r.email}),Object(_.jsx)("button",{onClick:function(){localStorage.removeItem("jwt"),n(!1),s(!1),o({_id:null,email:"",name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",about:"",avatar:u}),c.push("/sign-in")},className:"link header__link",children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(_.jsx)("button",{onClick:function(){return n(!t)},type:"button","aria-label":"\u041c\u0435\u043d\u044e",className:"btn btn_type_menu",style:{backgroundImage:"url(".concat(t?p:m)}})]})}function O(e){var t="/sign-in"===e.path;return Object(_.jsx)(b.b,{to:t?"/sign-up":"/sign-in",className:"link header__link",children:t?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438"})}var h=function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useContext)(j).isLoggedIn,s=Object(l.h)().pathname;return Object(_.jsxs)("header",{className:"header container ".concat(n?"header_menu-opened":""),children:[Object(_.jsx)("a",{href:"/",className:"logo",target:"_self",children:Object(_.jsx)("img",{src:d,alt:"Mesto Russia",className:"logo__img"})}),i?Object(_.jsx)(f,{openMenu:n,setOpenMenu:c}):Object(_.jsx)(O,{path:s})]})},v=n(7),x=n(12);var g=function(e){var t=e.onChange,n=e.value,c=Object(x.a)(e,["onChange","value"]),i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],j=Object(a.useRef)(),b=Object(a.useRef)();return Object(a.useEffect)((function(){if(l){var e=b.current,t=e.validity,n=e.validationMessage;t.valid?j.current.textContent="":j.current.textContent=n}}),[n,l]),Object(_.jsxs)("label",{className:"form__field",children:[Object(_.jsx)("input",Object(r.a)(Object(r.a)({},c),{},{value:n,ref:b,onChange:function(e){var n=e.target,a=n.value,c=n.name,i=n.validity;t(a,c,i.valid)},onBlur:function(){u(!0)}})),Object(_.jsx)("span",{ref:j,className:"form__input-error name-input-error"})]})};n(23);function y(e){var t=e.step,n=e.speed,a=e.delay,c=e.color,i=e.size,s=i/2,r=i/e.count*.7,o=.6*s;return Object(_.jsx)("g",{transform:"rotate(".concat(t," ").concat(s," ").concat(s,")"),children:Object(_.jsx)("rect",{x:s-r/2,y:"0",rx:"3",ry:"7",width:r,height:o,fill:c,children:Object(_.jsx)("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"".concat(n,"ms"),begin:"-".concat(a,"ms"),repeatCount:"indefinite"})})})}var k=function(e){var t=e.count,n=void 0===t?10:t,a=e.speed,c=void 0===a?1e3:a,i=e.color,s=void 0===i?"#ffffff":i,r=e.size,o=void 0===r?100:r;return Object(_.jsx)("div",{className:"loader",children:Object(_.jsx)("svg",{className:"loader__svg",width:"".concat(o,"px"),height:"".concat(o,"px"),preserveAspectRatio:"xMidYMid",children:function(){for(var e=360/n,t=c/n,a=[],i=0,r=c;i<360;i+=e,r-=t)a.push(Object(_.jsx)(y,{step:i,delay:r,speed:c,color:s,size:o,count:n},i));return a}()})})};var C=function(e){var t=e.onSubmit,n=e.fetching,c=Object(a.useState)({email:"",password:""}),i=Object(o.a)(c,2),s=i[0],l=i[1],u=function(e,t){l(Object(r.a)(Object(r.a)({},s),{},Object(v.a)({},t,e)))};return Object(_.jsx)("main",{className:"content",children:Object(_.jsxs)("form",{noValidate:!0,name:"sign-up",className:"form form_type_auth",onSubmit:function(e){e.preventDefault(),t(s)},children:[Object(_.jsxs)("div",{className:"form__body",children:[Object(_.jsx)("h1",{className:"form__title",children:"\u0412\u0445\u043e\u0434"}),Object(_.jsx)(g,{type:"email",name:"email",placeholder:"Email",id:"username-input",className:"form__input form__input_type_email form__input_style_dark",required:!0,minLength:"2",maxLength:"40",onChange:u,value:s.email}),Object(_.jsx)(g,{type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password-input",className:"form__input form__input_type_password form__input_style_dark",required:!0,minLength:"6",maxLength:"40",onChange:u,value:s.password})]}),Object(_.jsx)("div",{className:"form__actions",children:Object(_.jsx)("button",{type:"submit",name:"save",className:"form__save form__save_style_dark",children:n?Object(_.jsx)(k,{size:30,color:"#000"}):"\u0412\u043e\u0439\u0442\u0438"})})]})})},N=n(26),S=n(20),w=n(19),L=n(13),U=n(14),E=function(){function e(t){Object(L.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(U.a)(e,[{key:"_fetch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c="".concat(this._baseUrl,"/").concat(e),i={method:t,headers:Object.assign(this._headers,a)};return n&&(i.body=JSON.stringify(n)),fetch(c,i).then((function(e){return e.ok,e.json()}))}}]),e}(),I=function(e){Object(S.a)(n,e);var t=Object(w.a)(n);function n(){return Object(L.a)(this,n),t.apply(this,arguments)}return Object(U.a)(n,[{key:"register",value:function(e,t){return this._fetch("signup","POST",{email:e,password:t})}},{key:"auth",value:function(e,t){return this._fetch("signin","POST",{email:e,password:t})}},{key:"checkToken",value:function(e){var t={Authorization:"Bearer ".concat(e)};return this._fetch("users/me","GET",null,t)}}]),n}(E),P=new(function(e){Object(S.a)(n,e);var t=Object(w.a)(n);function n(){return Object(L.a)(this,n),t.apply(this,arguments)}return Object(U.a)(n,[{key:"getUserInfo",value:function(){return this._fetch("users/me")}},{key:"getCardList",value:function(){return this._fetch("cards")}},{key:"updateProfile",value:function(e){return this._fetch("users/me","PATCH",e)}},{key:"postCard",value:function(e){return this._fetch("cards","POST",e)}},{key:"delete",value:function(e){return this._fetch("cards/".concat(e),"DELETE")}},{key:"like",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._fetch("cards/likes/".concat(e),t?"PUT":"DELETE")}},{key:"updateAvatar",value:function(e){return this._fetch("users/me/avatar","PATCH",e)}}]),n}(E))({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-21",headers:{authorization:"52186c90-0ae5-45bb-99b5-e4acaa2b939f","Content-Type":"application/json"}}),T=new I({baseUrl:"https://auth.nomoreparties.co",headers:{"Content-Type":"application/json"}});function D(e){console.error(e.message)}function A(e){var t=e.onClickDelete;return Object(_.jsx)("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:"card__delete btn btn_type_delete",onClick:t})}function M(e){var t=e.onClickLike,n=e.isLiked,a=void 0!==n&&n,c=e.count,i=void 0===c?0:c,s="btn btn_type_like ".concat(a&&"btn_type_like-active");return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("button",{type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",className:s,onClick:t}),Object(_.jsx)("span",{className:"card__like-cnt",children:i})]})}var z=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,i=e.onCardDelete,s=Object(a.useState)(!1),r=Object(o.a)(s,2),l=r[0],u=r[1],b=Object(a.useContext)(j).currentUser._id,d=t.owner._id===b,m=t.likes.some((function(e){return e._id===b}));return Object(_.jsx)("li",{className:"cards__list-item",children:Object(_.jsxs)("article",{className:"card",children:[d&&Object(_.jsx)(A,{onClickDelete:function(){i(t._id)}}),Object(_.jsx)("img",{src:t.link,alt:t.name,className:"card__image",onClick:function(){n(t)}}),Object(_.jsxs)("div",{className:"card__description",children:[Object(_.jsx)("h2",{className:"card__title",children:t.name}),Object(_.jsx)("div",{className:"card__like",children:l?Object(_.jsx)(k,{size:30,color:"black"}):Object(_.jsx)(M,{onClickLike:function(){c(t,u)},isLiked:m,count:t.likes.length})})]})]})})};var q=function(e){var t,n=Object(a.useContext)(j).currentUser,c=n.name,i=n.about,s=n.avatar,r=e.cards,o=e.onCardLike,l=e.onCardDelete,u=e.onAddPlace,b=e.onEditAvatar,d=e.onEditProfile,m=e.onCardClick,p=e.loading,f=void 0!==p&&p;return Object(_.jsxs)("main",{className:"content container",children:[Object(_.jsxs)("section",{className:"profile",children:[Object(_.jsx)("div",{className:"profile__avatar-wrapper",onClick:b,children:Object(_.jsx)("img",{src:s,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar"})}),Object(_.jsxs)("div",{className:"profile__details",children:[Object(_.jsxs)("div",{className:"profile__text",children:[Object(_.jsx)("h1",{className:"profile__name",children:c}),Object(_.jsx)("button",{type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",className:"btn btn_type_edit-profile",onClick:d})]}),Object(_.jsx)("p",{className:"profile__about",children:i})]}),Object(_.jsx)("button",{type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",className:"btn btn_type_add-card",onClick:u})]}),Object(_.jsx)("section",{className:"cards",children:f?Object(_.jsx)(k,{}):(t=r,Object(_.jsx)("ul",{className:"cards__list",children:t.map((function(e){return Object(_.jsx)(z,{card:e,onCardLike:o,onCardDelete:l,onCardClick:m},e._id)}))}))})]})};var R=function(){return Object(_.jsx)("footer",{className:"footer container",children:Object(_.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var B=function(e){var t=e.card,n=e.onClose,a="popup popup_type_image ".concat(t?"popup_opened":"");return Object(_.jsx)("div",{className:a,children:Object(_.jsxs)("div",{className:"popup__container popup__container_image",children:[Object(_.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:n}),Object(_.jsx)("img",{src:t&&t.link,alt:t&&t.name,className:"popup__image"}),Object(_.jsx)("h2",{className:"popup__sign",children:t&&t.name})]})})};var F=function(e){var t=e.title,n=e.name,a=e.isOpen,c=e.onClose,i=e.onSubmit,s=e.children,r=e.submitting,o=void 0!==r&&r,l=e.disabled,u=void 0!==l&&l,j=e.buttonText,b=void 0===j?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":j,d="popup popup_type_".concat(n," ").concat(a&&"popup_opened"),m="form__save form__save_style_light ".concat(u&&"form__save_disabled");return Object(_.jsx)("div",{className:d,children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:c}),Object(_.jsx)("h2",{className:"popup__title",children:t}),Object(_.jsxs)("form",{name:"form-".concat(n),className:"form form_type_".concat(n),noValidate:!0,onSubmit:i,children:[s,Object(_.jsx)("button",{type:"submit",name:"save",className:m,disabled:u,children:o?Object(_.jsx)(k,{size:30,count:15,speed:700}):b})]})]})})};var J=function(e){var t=e.onClose,n=e.onUpdateUser,c=e.open,i=void 0!==c&&c,s=e.submitting,l=void 0!==s&&s,u=Object(a.useContext)(j).currentUser,b=Object(a.useMemo)((function(){return{name:{value:u.name,valid:!0},about:{value:u.about,valid:!0}}}),[u]),d=Object(a.useState)(b),m=Object(o.a)(d,2),p=m[0],f=m[1],O=Object(a.useState)(!0),h=Object(o.a)(O,2),x=h[0],y=h[1],k=function(e,t,n){f(Object(r.a)(Object(r.a)({},p),{},Object(v.a)({},t,{value:e,valid:n})))};return Object(a.useEffect)((function(){p.name.valid&&p.about.valid?y(!0):y(!1)}),[p]),Object(a.useEffect)((function(){f(b)}),[u,i,f,b]),Object(_.jsxs)(F,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",isOpen:i,disabled:!x,onClose:t,onSubmit:function(e){e.preventDefault(),n({name:p.name.value,about:p.about.value})},submitting:l,children:[Object(_.jsx)(g,{type:"text",name:"name",id:"name-input",className:"form__input form__input_type_name form__input_style_light",required:!0,minLength:"2",maxLength:"40",value:p.name.value,onChange:k}),Object(_.jsx)(g,{type:"text",name:"about",id:"about-input",className:"form__input form__input_type_about form__input_style_light",required:!0,minLength:"2",maxLength:"200",value:p.about.value,onChange:k})]})};var V=function(e){var t=e.onClose,n=e.onAddPlace,c=e.submitting,i=void 0!==c&&c,s=e.open,l=void 0!==s&&s,u={name:{value:"",valid:!1},link:{value:"",valid:!1}},j=Object(a.useState)(u),b=Object(o.a)(j,2),d=b[0],m=b[1],p=Object(a.useState)(!1),f=Object(o.a)(p,2),O=f[0],h=f[1],x=function(e,t,n){m(Object(r.a)(Object(r.a)({},d),{},Object(v.a)({},t,{value:e,valid:n})))},y=function(){m(u)};return Object(a.useEffect)((function(){d.name.valid&&d.link.valid?h(!0):h(!1)}),[d]),Object(_.jsxs)(F,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",isOpen:l,disabled:!O,onClose:function(){m(u),t()},onSubmit:function(e){e.preventDefault();var t=d.name,a=d.link;n({name:t.value,link:a.value},y)},submitting:i,children:[Object(_.jsx)(g,{value:d.name.value,onChange:x,type:"text",name:"name",id:"place-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input form__input_style_light form__input_type_card-name",required:!0,minLength:"2",maxLength:"30"}),Object(_.jsx)(g,{value:d.link.value,onChange:x,type:"url",name:"link",id:"link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input form__input_style_light form__input_type_link",required:!0})]})};var G=function(e){var t=e.cardId,n=e.onClose,a=e.onDeleteCard,c=e.submitting,i=void 0!==c&&c;return Object(_.jsx)(F,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",name:"delete",isOpen:!!t,onClose:n,onSubmit:function(e){e.preventDefault(),a(t)},submitting:i,children:Object(_.jsx)("input",{type:"hidden",className:"form__input form__input_type_id",name:"id"})})};var H=function(e){var t=e.onClose,n=e.onUpdateAvatar,a=e.open,i=void 0!==a&&a,s=e.submitting,r=void 0!==s&&s,o=c.a.useRef();return Object(_.jsx)(F,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"update-profile",isOpen:i,onClose:t,onSubmit:function(e){e.preventDefault(),n({avatar:o.current.value})},submitting:r,children:Object(_.jsxs)("label",{className:"form__field",children:[Object(_.jsx)("input",{ref:o,type:"url",name:"avatar",id:"avatar-input",className:"form__input form__input_type_link form__input_style_light",required:!0}),Object(_.jsx)("span",{className:"form__input-error avatar-input-error"})]})})};n(38);var Y=function(){var e=Object(a.useState)(!0),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),s=Object(o.a)(i,2),l=s[0],u=s[1],b=Object(a.useState)(!1),d=Object(o.a)(b,2),m=d[0],p=d[1],f=Object(a.useState)(!1),O=Object(o.a)(f,2),h=O[0],v=O[1],x=Object(a.useState)(!1),g=Object(o.a)(x,2),y=g[0],k=g[1],C=Object(a.useState)([]),S=Object(o.a)(C,2),w=S[0],L=S[1],U=Object(a.useState)(null),E=Object(o.a)(U,2),I=E[0],T=E[1],A=Object(a.useState)(null),M=Object(o.a)(A,2),z=M[0],F=M[1],Y=Object(a.useContext)(j),K=Y.currentUser,Q=Y.setCurrentUser,W=function(){p(!1),v(!1),k(!1),F(null),T(null)};return Object(a.useEffect)((function(){c(!0),console.log(K),Promise.all([P.getUserInfo(),P.getCardList()]).then((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];Q(Object(r.a)(Object(r.a)({},K),n)),L(a)})).catch(D).finally((function(){c(!1)}))}),[]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(q,{cards:w,onCardLike:function(e,t){var n=e.likes.some((function(e){return e._id===K._id}));t(!0),P.like(e._id,!n).then((function(t){L((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch(D).finally((function(){return t(!1)}))},onCardDelete:function(e){F(e)},onEditProfile:function(){v(!0)},onAddPlace:function(){k(!0)},onEditAvatar:function(){p(!0)},onCardClick:function(e){T(e)},loading:n}),Object(_.jsx)(R,{}),Object(_.jsx)(B,{card:I,onClose:W}),Object(_.jsx)(J,{open:h,onClose:W,onUpdateUser:function(e){u(!0),P.updateProfile(e).then((function(e){Q(Object(r.a)(Object(r.a)({},K),e)),v(!1)})).catch(D).finally((function(){return u(!1)}))},submitting:l}),Object(_.jsx)(V,{open:y,onClose:W,onAddPlace:function(e,t){u(!0),P.postCard(e).then((function(e){L([e].concat(Object(N.a)(w))),k(!1),t()})).catch(D).finally((function(){return u(!1)}))},submitting:l}),Object(_.jsx)(G,{cardId:z,onClose:W,onDeleteCard:function(e){u(!0),P.delete(e).then((function(){L((function(t){return t.filter((function(t){return t._id!==e}))})),F(null)})).catch(D).finally((function(){return u(!1)}))},submitting:l}),Object(_.jsx)(H,{open:m,onClose:W,onUpdateAvatar:function(e){u(!0),P.updateAvatar(e).then((function(e){Q(Object(r.a)(Object(r.a)({},K),e)),p(!1)})).catch(D).finally((function(){return u(!1)}))},submitting:l})]})};var K=function(e){var t=e.onSubmit,n=e.fetching,c=Object(a.useState)({email:"",password:""}),i=Object(o.a)(c,2),s=i[0],l=i[1],u=function(e,t){l(Object(r.a)(Object(r.a)({},s),{},Object(v.a)({},t,e)))};return Object(_.jsx)("main",{className:"content",children:Object(_.jsxs)("form",{noValidate:!0,name:"sign-up",className:"form form_type_auth",onSubmit:function(e){e.preventDefault(),t(s)},children:[Object(_.jsxs)("div",{className:"form__body",children:[Object(_.jsx)("h1",{className:"form__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(_.jsx)(g,{type:"email",name:"email",placeholder:"Email",id:"username-input",className:"form__input form__input_type_email form__input_style_dark",required:!0,minLength:"2",maxLength:"40",onChange:u,value:s.email}),Object(_.jsx)(g,{type:"password",name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",id:"password-input",className:"form__input form__input_type_password form__input_style_dark",required:!0,minLength:"6",maxLength:"40",onChange:u,value:s.password})]}),Object(_.jsxs)("div",{className:"form__actions",children:[Object(_.jsx)("button",{type:"submit",name:"save",className:"form__save form__save_style_dark",children:n?Object(_.jsx)(k,{size:30,color:"#000"}):"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(_.jsxs)("div",{className:"form__after-save",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",Object(_.jsx)(b.b,{to:"/sign-in",className:"link form__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})]})})};var Q=function(e){var t=e.component,n=e.isloggedIn,a=e.path,c=Object(x.a)(e,["component","isloggedIn","path"]);return Object(_.jsx)(l.b,{path:a,children:n?Object(_.jsx)(t,Object(r.a)({},c)):Object(_.jsx)(l.a,{to:"/sign-in"})})},W=n.p+"static/media/success-icon.1b6082f8.svg",X=n.p+"static/media/fail-icon.7c6a020b.svg";var Z=function(e){var t=e.open,n=e.onClose,a=e.success,c=e.title;return Object(_.jsx)("div",{className:"popup ".concat(t?"popup_opened":""),children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:n}),Object(_.jsx)("div",{className:"popup__icon","aria-label":a?"\u0423\u0441\u043f\u0435\u0448\u043d\u0430\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",style:{backgroundImage:"url(".concat(a?W:X,")")}}),Object(_.jsx)("h2",{className:"popup__title popup__title_place_register",children:c})]})})};var $=function(){var e=Object(l.g)(),t=Object(a.useState)(Object(a.useContext)(j)),n=Object(o.a)(t,2),c=n[0],i=n[1],s=Object(a.useState)(!1),u=Object(o.a)(s,2),b=u[0],d=u[1],m=Object(a.useState)(!1),p=Object(o.a)(m,2),f=p[0],O=p[1],v=Object(a.useState)({status:!1,message:""}),x=Object(o.a)(v,2),g=x[0],y=x[1],N=Object(a.useState)(!1),S=Object(o.a)(N,2),w=S[0],L=S[1],U=Object(a.useState)(!1),E=Object(o.a)(U,2),I=E[0],P=E[1],A=function(t){var n=t.data.email;i(Object(r.a)(Object(r.a)({},c),{},{email:n})),L(!0),e.push("/")};return Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e?T.checkToken(e).then(A).catch(D).finally((function(){return P(!0)})):P(!0)}),[]),I?Object(_.jsx)(j.Provider,{value:{currentUser:c,setCurrentUser:i,isLoggedIn:w,setIsloggedIn:L},children:Object(_.jsxs)("div",{className:"page",children:[Object(_.jsx)(h,{}),Object(_.jsxs)(l.d,{children:[Object(_.jsx)(l.b,{path:"/sign-in",children:Object(_.jsx)(C,{onSubmit:function(e){var t=e.email,n=e.password;O(!0),T.auth(t,n).then((function(e){var t=e.token,n=e.message;return t?(localStorage.setItem("jwt",t),T.checkToken(t)):Promise.reject(n)})).then(A).catch((function(e){y({status:!1,message:e.toString()||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),d(!0),D(e)})).finally((function(){O(!1)}))},fetching:f})}),Object(_.jsx)(l.b,{path:"/sign-up",children:Object(_.jsx)(K,{onSubmit:function(t){var n=t.email,a=t.password;O(!0),T.register(n,a).then((function(e){var t=e.data,s=e.error;return s?Promise.reject(s):(i(Object(r.a)(Object(r.a)({},c),{},{email:t.email,_id:t._id})),T.auth(n,a))})).then((function(t){var n=t.token,a=t.error;if(a)return Promise.reject(a);localStorage.setItem("jwt",n),L(!0),e.push("/"),y({status:!0,message:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"})})).catch((function(e){y({status:!1,message:e.toString()||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),D(e)})).finally((function(){d(!0),O(!1)}))},fetching:f})}),Object(_.jsx)(Q,{path:"/",component:Y,isloggedIn:w})]}),Object(_.jsx)(Z,{open:b,title:g.message,success:g.status,onClose:function(){d(!1)}})]})}):Object(_.jsx)("div",{className:"page page_loading",children:Object(_.jsx)(k,{size:150,count:20})})};s.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(b.a,{children:Object(_.jsx)($,{})})}),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.d0490339.chunk.js.map