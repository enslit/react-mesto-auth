(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(7),s=n.n(i),o=(n(16),n(10)),r=n(2),l=n.p+"static/media/spinner.c233b9e0.svg",u=Object(a.createContext)({_id:null,name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",about:"",avatar:l}),d=n(8),b=n(9),j=new(function(){function e(t){Object(d.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(b.a)(e,[{key:"_fetch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a="".concat(this._baseUrl,"/").concat(e),c={method:t,headers:this._headers};return n&&(c.body=JSON.stringify(n)),fetch(a,c).then((function(e){if(!e.ok){var t=new Error("Error code ".concat(e.status,". Message ").concat(e.statusText));return Promise.reject(t)}return e.json()}))}},{key:"getUserInfo",value:function(){return this._fetch("users/me")}},{key:"getCardList",value:function(){return this._fetch("cards")}},{key:"updateProfile",value:function(e){return this._fetch("users/me","PATCH",e)}},{key:"postCard",value:function(e){return this._fetch("cards","POST",e)}},{key:"delete",value:function(e){return this._fetch("cards/".concat(e),"DELETE")}},{key:"like",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._fetch("cards/likes/".concat(e),t?"PUT":"DELETE")}},{key:"updateAvatar",value:function(e){return this._fetch("users/me/avatar","PATCH",e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-21",headers:{authorization:"52186c90-0ae5-45bb-99b5-e4acaa2b939f","Content-Type":"application/json"}});function f(e){console.error(e.message)}var p=n.p+"static/media/logo.9efe1e8a.svg",m=n(0);var _=function(){return Object(m.jsx)("header",{className:"header container",children:Object(m.jsx)("a",{href:"/",className:"logo",target:"_self",children:Object(m.jsx)("img",{src:p,alt:"Mesto Russia",className:"logo__img"})})})};function O(e){var t=e.step,n=e.speed,a=e.delay,c=e.color,i=e.size,s=i/2,o=i/e.count*.7,r=.6*s;return Object(m.jsx)("g",{transform:"rotate(".concat(t," ").concat(s," ").concat(s,")"),children:Object(m.jsx)("rect",{x:s-o/2,y:"0",rx:"3",ry:"7",width:o,height:r,fill:c,children:Object(m.jsx)("animate",{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"".concat(n,"ms"),begin:"-".concat(a,"ms"),repeatCount:"indefinite"})})})}var h=function(e){var t=e.count,n=void 0===t?10:t,a=e.speed,c=void 0===a?1e3:a,i=e.color,s=void 0===i?"#ffffff":i,o=e.size,r=void 0===o?100:o;return Object(m.jsx)("div",{className:"loader",children:Object(m.jsx)("svg",{className:"loader__svg",width:"".concat(r,"px"),height:"".concat(r,"px"),preserveAspectRatio:"xMidYMid",children:function(){for(var e=360/n,t=c/n,a=[],i=0,o=c;i<360;i+=e,o-=t)a.push(Object(m.jsx)(O,{step:i,delay:o,speed:c,color:s,size:r,count:n},i));return a}()})})};function v(e){var t=e.onClickDelete;return Object(m.jsx)("button",{type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",className:"card__delete btn btn_type_delete",onClick:t})}function x(e){var t=e.onClickLike,n=e.isLiked,a=void 0!==n&&n,c=e.count,i=void 0===c?0:c,s="btn btn_type_like ".concat(a&&"btn_type_like-active");return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",className:s,onClick:t}),Object(m.jsx)("span",{className:"card__like-cnt",children:i})]})}var g=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,i=e.onCardDelete,s=Object(a.useState)(!1),o=Object(r.a)(s,2),l=o[0],d=o[1],b=Object(a.useContext)(u)._id,j=t.owner._id===b,f=t.likes.some((function(e){return e._id===b}));return Object(m.jsx)("li",{className:"cards__list-item",children:Object(m.jsxs)("article",{className:"card",children:[j&&Object(m.jsx)(v,{onClickDelete:function(){i(t._id)}}),Object(m.jsx)("img",{src:t.link,alt:t.name,className:"card__image",onClick:function(){n(t)}}),Object(m.jsxs)("div",{className:"card__description",children:[Object(m.jsx)("h2",{className:"card__title",children:t.name}),Object(m.jsx)("div",{className:"card__like",children:l?Object(m.jsx)(h,{size:30,color:"black"}):Object(m.jsx)(x,{onClickLike:function(){c(t,d)},isLiked:f,count:t.likes.length})})]})]})})};var C=function(e){var t,n=Object(a.useContext)(u),c=n.name,i=n.about,s=n.avatar,o=e.cards,r=e.onCardLike,l=e.onCardDelete,d=e.onAddPlace,b=e.onEditAvatar,j=e.onEditProfile,f=e.onCardClick,p=e.loading,_=void 0!==p&&p;return Object(m.jsxs)("main",{className:"content container",children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsx)("div",{className:"profile__avatar-wrapper",onClick:b,children:Object(m.jsx)("img",{src:s,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar"})}),Object(m.jsxs)("div",{className:"profile__details",children:[Object(m.jsxs)("div",{className:"profile__text",children:[Object(m.jsx)("h1",{className:"profile__name",children:c}),Object(m.jsx)("button",{type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",className:"btn btn_type_edit-profile",onClick:j})]}),Object(m.jsx)("p",{className:"profile__about",children:i})]}),Object(m.jsx)("button",{type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",className:"btn btn_type_add-card",onClick:d})]}),Object(m.jsx)("section",{className:"cards",children:_?Object(m.jsx)(h,{}):(t=o,Object(m.jsx)("ul",{className:"cards__list",children:t.map((function(e){return Object(m.jsx)(g,{card:e,onCardLike:r,onCardDelete:l,onCardClick:f},e._id)}))}))})]})};var y=function(){return Object(m.jsx)("footer",{className:"footer container",children:Object(m.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var k=function(e){var t=e.card,n=e.onClose,a="popup popup_type_image ".concat(t?"popup_opened":"");return Object(m.jsx)("div",{className:a,children:Object(m.jsxs)("div",{className:"popup__container popup__container_image",children:[Object(m.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:n}),Object(m.jsx)("img",{src:t&&t.link,alt:t&&t.name,className:"popup__image"}),Object(m.jsx)("h2",{className:"popup__sign",children:t&&t.name})]})})};var N=function(e){var t=e.title,n=e.name,a=e.isOpen,c=e.onClose,i=e.onSubmit,s=e.children,o=e.submitting,r=void 0!==o&&o,l=e.disabled,u=void 0!==l&&l,d=e.buttonText,b=void 0===d?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":d,j="popup popup_type_".concat(n," ").concat(a&&"popup_opened"),f="form__save ".concat(u&&"form__save_disabled");return Object(m.jsx)("div",{className:j,children:Object(m.jsxs)("div",{className:"popup__container",children:[Object(m.jsx)("button",{type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",className:"popup__close btn btn_type_close",onClick:c}),Object(m.jsx)("h2",{className:"popup__title",children:t}),Object(m.jsxs)("form",{name:"form-".concat(n),className:"form form_type_".concat(n),noValidate:!0,onSubmit:i,children:[s,Object(m.jsx)("button",{type:"submit",name:"save",className:f,disabled:u,children:r?Object(m.jsx)(h,{size:30,count:15,speed:700}):b})]})]})})},S=n(6),E=n(11);var L=function(e){var t=e.onChange,n=e.value,c=Object(E.a)(e,["onChange","value"]),i=Object(a.useState)(!1),s=Object(r.a)(i,2),o=s[0],l=s[1],u=Object(a.useRef)(),d=Object(a.useRef)();return Object(a.useEffect)((function(){if(o){var e=d.current,t=e.validity,n=e.validationMessage;t.valid?u.current.textContent="":u.current.textContent=n}}),[n,o]),Object(m.jsxs)("label",{className:"form__field",children:[Object(m.jsx)("input",Object(S.a)(Object(S.a)({},c),{},{ref:d,onChange:function(e){var n=e.target,a=n.value,c=n.validity;t(a,c.valid)},onBlur:function(){l(!0)}})),Object(m.jsx)("span",{ref:u,className:"form__input-error name-input-error"})]})};var P=function(e){var t=e.onClose,n=e.onUpdateUser,c=e.open,i=void 0!==c&&c,s=e.submitting,o=void 0!==s&&s,l=Object(a.useContext)(u),d=Object(a.useState)(l.name),b=Object(r.a)(d,2),j=b[0],f=b[1],p=Object(a.useState)(l.about),_=Object(r.a)(p,2),O=_[0],h=_[1],v=Object(a.useState)(!0),x=Object(r.a)(v,2),g=x[0],C=x[1],y=Object(a.useState)(!0),k=Object(r.a)(y,2),S=k[0],E=k[1],P=Object(a.useState)(!0),D=Object(r.a)(P,2),A=D[0],U=D[1];return Object(a.useEffect)((function(){U(!(!g||!S))}),[g,S]),Object(a.useEffect)((function(){f(l.name),h(l.about),C(!!l.name),E(!!l.about)}),[l,i]),Object(m.jsxs)(N,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",isOpen:i,disabled:!A,onClose:t,onSubmit:function(e){e.preventDefault(),n({name:j,about:O})},submitting:o,children:[Object(m.jsx)(L,{type:"text",name:"name",id:"name-input",className:"form__input form__input_type_name",required:!0,minLength:"2",maxLength:"40",value:j,onChange:function(e,t){C(t),f(e)}}),Object(m.jsx)(L,{type:"text",name:"about",id:"about-input",className:"form__input form__input_type_about",required:!0,minLength:"2",maxLength:"200",value:O,onChange:function(e,t){E(t),h(e)}})]})};var D=function(e){var t=e.onClose,n=e.onUpdateAvatar,a=e.open,i=void 0!==a&&a,s=e.submitting,o=void 0!==s&&s,r=c.a.useRef();return Object(m.jsx)(N,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"update-profile",isOpen:i,onClose:t,onSubmit:function(e){e.preventDefault(),n({avatar:r.current.value})},submitting:o,children:Object(m.jsxs)("label",{className:"form__field",children:[Object(m.jsx)("input",{ref:r,type:"url",name:"avatar",id:"avatar-input",className:"form__input form__input_type_link",required:!0}),Object(m.jsx)("span",{className:"form__input-error avatar-input-error"})]})})};var A=function(e){var t=e.onClose,n=e.onAddPlace,c=e.submitting,i=void 0!==c&&c,s=e.open,o=void 0!==s&&s,l=Object(a.useState)(""),u=Object(r.a)(l,2),d=u[0],b=u[1],j=Object(a.useState)(""),f=Object(r.a)(j,2),p=f[0],_=f[1],O=Object(a.useState)(!1),h=Object(r.a)(O,2),v=h[0],x=h[1],g=Object(a.useState)(!1),C=Object(r.a)(g,2),y=C[0],k=C[1],S=Object(a.useState)(!1),E=Object(r.a)(S,2),P=E[0],D=E[1],A=function(){b(""),_("")};return Object(a.useEffect)((function(){D(!(!v||!y))}),[v,y]),Object(m.jsxs)(N,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",isOpen:o,disabled:!P,onClose:function(){x(!1),k(!1),b(""),_(""),t()},onSubmit:function(e){e.preventDefault(),n({name:d,link:p},A)},submitting:i,children:[Object(m.jsx)(L,{value:d,onChange:function(e,t){x(t),b(e)},type:"text",name:"name",id:"place-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input form__input_type_card-name",required:!0,minLength:"2",maxLength:"30"}),Object(m.jsx)(L,{value:p,onChange:function(e,t){k(t),_(e)},type:"url",name:"link",id:"link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input form__input_type_link",required:!0})]})};var U=function(e){var t=e.cardId,n=e.onClose,a=e.onDeleteCard,c=e.submitting,i=void 0!==c&&c;return Object(m.jsx)(N,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:"\u0414\u0430",name:"delete",isOpen:!!t,onClose:n,onSubmit:function(e){e.preventDefault(),a(t)},submitting:i,children:Object(m.jsx)("input",{type:"hidden",className:"form__input form__input_type_id",name:"id"})})};var T=function(){var e=Object(a.useState)(!0),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(!1),s=Object(r.a)(i,2),l=s[0],d=s[1],b=Object(a.useState)(!1),p=Object(r.a)(b,2),O=p[0],h=p[1],v=Object(a.useState)(!1),x=Object(r.a)(v,2),g=x[0],N=x[1],S=Object(a.useState)(!1),E=Object(r.a)(S,2),L=E[0],T=E[1],w=Object(a.useState)([]),M=Object(r.a)(w,2),z=M[0],R=M[1],q=Object(a.useState)(null),I=Object(r.a)(q,2),J=I[0],B=I[1],H=Object(a.useState)(null),F=Object(r.a)(H,2),G=F[0],V=F[1],Y=Object(a.useState)(Object(a.useContext)(u)),K=Object(r.a)(Y,2),Q=K[0],W=K[1],X=function(){h(!1),N(!1),T(!1),V(null),B(null)};return Object(a.useEffect)((function(){c(!0),Promise.all([j.getUserInfo(),j.getCardList()]).then((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];W(n),R(a)})).catch(f).finally((function(){c(!1)}))}),[]),Object(m.jsx)(u.Provider,{value:Q,children:Object(m.jsxs)("div",{className:"page",children:[Object(m.jsx)(_,{}),Object(m.jsx)(C,{cards:z,onCardLike:function(e,t){var n=e.likes.some((function(e){return e._id===Q._id}));t(!0),j.like(e._id,!n).then((function(t){R((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch(f).finally((function(){return t(!1)}))},onCardDelete:function(e){V(e)},onEditProfile:function(){N(!0)},onAddPlace:function(){T(!0)},onEditAvatar:function(){h(!0)},onCardClick:function(e){B(e)},loading:n}),Object(m.jsx)(y,{}),Object(m.jsx)(k,{card:J,onClose:X}),Object(m.jsx)(P,{open:g,onClose:X,onUpdateUser:function(e){d(!0),j.updateProfile(e).then((function(e){W(e),N(!1)})).catch(f).finally((function(){return d(!1)}))},submitting:l}),Object(m.jsx)(A,{open:L,onClose:X,onAddPlace:function(e,t){d(!0),j.postCard(e).then((function(e){R([e].concat(Object(o.a)(z))),T(!1),t()})).catch(f).finally((function(){return d(!1)}))},submitting:l}),Object(m.jsx)(U,{cardId:G,onClose:X,onDeleteCard:function(e){d(!0),j.delete(e).then((function(){R((function(t){return t.filter((function(t){return t._id!==e}))})),V(null)})).catch(f).finally((function(){return d(!1)}))},submitting:l}),Object(m.jsx)(D,{open:O,onClose:X,onUpdateAvatar:function(e){d(!0),j.updateAvatar(e).then((function(e){W(e),h(!1)})).catch(f).finally((function(){return d(!1)}))},submitting:l})]})})};s.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(T,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.1a866c74.chunk.js.map